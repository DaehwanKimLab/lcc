# rna damage
# endoRNases
# exoRNases
'''
[from wcs count data]
[endoRnase counts] - "kcat (1 / units.s) = 0.1 for all"
EG10856-MONOMER[p]	652
EG10857-MONOMER[c]	581
EG10859-MONOMER[i]	953
EG10860-MONOMER[c]	228
EG10861-MONOMER[c]	105
EG10862-MONOMER[c]	187
EG11299-MONOMER[c]	143
G7175-MONOMER[c]	138
G7365-MONOMER[c]	296

[exoRNases counts]
EG11620-MONOMER[c]	1651
G7175-MONOMER[c]	138
EG10858-MONOMER[c]	5
EG10863-MONOMER[c]	0
EG11259-MONOMER[c]	286
EG11547-MONOMER[c]	1
EG10746-MONOMER[c]	373
G7842-MONOMER[c]	0
EG10743-MONOMER[c]	2

[Pyrophosphohydrolases]
GeneID:  EG10572 	ProtID:  EG10572-MONOMER 	Name:  nucleoside triphosphate pyrophosphohydrolase
GeneID:  EG11138 	ProtID:  H2NEOPTERINP3PYROPHOSPHOHYDRO-MONOMER 	Name:  dihydroneopterin triphosphate pyrophosphohydrolase
GeneID:  G7164 	ProtID:  G7164-MONOMER 	Name:  pyrimidine deoxynucleoside triphosphate pyrophosphohydrolase
GeneID:  G7459 	ProtID:  G7459-MONOMER 	Name:  RNA pyrophosphohydrolase

[endoribonucleases]
GeneID:  EG12845 	ProtID:  EG12845-MONOMER 	Name:  predicted endoribonuclease
GeneID:  G6362 	ProtID:  G6362-MONOMER 	Name:  endoribonuclease involved in maturation of 16S rRNA and ribosome quality control
GeneID:  G7879 	ProtID:  G7879-MONOMER 	Name:  predicted mRNA endoribonuclease

[exoribonucleases]

[RNases]
GeneID:  EG10856 	ProtID:  EG10856-MONOMER 	Name:  RNase I, cleaves phosphodiester bond between any two nucleotides
GeneID:  EG10857 	ProtID:  EG10857-MONOMER 	Name:  RNase III
GeneID:  EG10858 	ProtID:  EG10858-MONOMER 	Name:  RNase D
GeneID:  EG10859 	ProtID:  EG10859-MONOMER 	Name:  RNase E
GeneID:  EG10860 	ProtID:  EG10860-MONOMER 	Name:  RNase HI, degrades RNA of DNA-RNA hybrids, participates in DNA replication
GeneID:  EG10862 	ProtID:  EG10862-MONOMER 	Name:  RNase P protein component; processes tRNA, 4.5S RNA
GeneID:  EG10863 	ProtID:  EG10863-MONOMER 	Name:  RNase PH monomer
GeneID:  EG11259 	ProtID:  EG11259-MONOMER 	Name:  RNase R
GeneID:  EG12146 	ProtID:  EG12146-MONOMER 	Name:  RNase adaptor protein
GeneID:  G6550 	ProtID:  G6550-MONOMER 	Name:  O-acetyl-ADP-ribose deacetylase, regulator of RNase III activity
GeneID:  G6639 	ProtID:  G6639-MONOMER 	Name:  modulator of RNase II stability
GeneID:  G7365 	ProtID:  G7365-MONOMER 	Name:  CP4-57 prophage; RNase LS

[ribonucleases]
GeneID:  EG11249 	ProtID:  EG11249-MONOMER 	Name:  MazF toxin of the MazF-MazE toxin-antitoxin system that exhibits ribonuclease activity
GeneID:  EG11299 	ProtID:  EG11299-MONOMER 	Name:  ribonuclease G (RNAse G) monomer
GeneID:  EG11620 	ProtID:  EG11620-MONOMER 	Name:  ribonuclease II
GeneID:  EG11879 	ProtID:  EG11879-MONOMER 	Name:  ribonuclease E inhibitor protein
GeneID:  EG12845 	ProtID:  EG12845-MONOMER 	Name:  predicted endoribonuclease
GeneID:  G6306 	ProtID:  G6306-MONOMER 	Name:  endodeoxyribonuclease RUS (Holliday junction resolvase)
GeneID:  G6362 	ProtID:  G6362-MONOMER 	Name:  endoribonuclease involved in maturation of 16S rRNA and ribosome quality control
GeneID:  G7842 	ProtID:  G7842-MONOMER 	Name:  oligoribonuclease monomer
GeneID:  G7879 	ProtID:  G7879-MONOMER 	Name:  predicted mRNA endoribonuclease
GeneID:  G7885 	ProtID:  G7885-MONOMER 	Name:  ribonuclease E inhibitor protein B

[Phosphorylases]
GeneID:  EG10222 	ProtID:  DEOD-MONOMER 	Name:  purine nucleoside phosphorylase
GeneID:  EG10381 	ProtID:  EG10381-MONOMER 	Name:  glycogen phosphorylase-limit dextrin &alpha;-1,6-glucohydrolase
GeneID:  EG10560 	ProtID:  MALDEXPHOSPHORYL-MONOMER 	Name:  maltodextrin phosphorylase monomer
GeneID:  EG10743 	ProtID:  EG10743-MONOMER 	Name:  polynucleotide phosphorylase monomer
GeneID:  EG11454 	ProtID:  DTDPGLUCOSEPP2-MONOMER 	Name:  dTDP-glucose pyrophosphorylase 2
GeneID:  EG11580 	ProtID:  EG11580-MONOMER 	Name:  predicted transferase/phosphorylase
GeneID:  EG11978 	ProtID:  DTDPGLUCOSEPP-MONOMER 	Name:  dTDP-glucose pyrophosphorylase

[RhlB]
GeneID:  EG10844 	ProtID:  EG10844-MONOMER 	Name:  RhlB

[RNA helicases]
GeneID:  EG10210 	ProtID:  EG10210-MONOMER 	Name:  ATP-dependent RNA helicase, specific for 23S rRNA
GeneID:  EG10215 	ProtID:  EG10215-MONOMER 	Name:  DeaD, DEAD-box RNA helicase
GeneID:  EG10975 	ProtID:  EG10975-MONOMER 	Name:  SrmB, DEAD-box RNA helicase
GeneID:  EG11235 	ProtID:  EG11235-MONOMER 	Name:  ATP-dependent RNA helicase

'''

def Write_CellProcess(Writer, Comp, ProGen, ProcessID):

    # Molecule indices for Molecular IDs

    # Enolase - RppH
    Idx_Enolase_RppH = Comp.Master.ID2Idx_Master['G7459-MONOMER']
    Idx_Eno = Comp.Master.ID2Idx_Master[Comp.Protein.Name2ID_Proteins['Eno']]

    # Endoribonuclease - RNaseE or Y
    Idx_EndoRNase_RNaseE = Comp.Master.ID2Idx_Master['EG10859-MONOMER']
    # TODO: Inhibitors of RNaseE: RraA and RraB (RraA also targets PNPase)

    # 3' to 5' Exoribonucleases
    # hydrolytic catalytic activity - in E. coli, hydrolytic exoRNases appear independent of degradosome
    Idx_ExoRNaseHydrolytic_RNaseII = Comp.Master.ID2Idx_Master['EG11620-MONOMER']   # mRNA decay
    Idx_ExoRNaseHydrolytic_RNaseR = Comp.Master.ID2Idx_Master['EG11259-MONOMER']
    # phosphorolytic catalytic activity - for E. coli, mostly with degradosome
    Idx_ExoRNasePhosphorolytic_PNPase = Comp.Master.ID2Idx_Master['EG10743-MONOMER']   # mRNA decay

    # PolyA polymerase - PAP I pcnB
    Idx_PolyAP_PcnB = Comp.Master.ID2Idx_Master['EG10690-MONOMER']

    # RNA helicases  RhlB CshA
    Idx_RNAHelicase_RhlB = Comp.Master.ID2Idx_Master['EG10844-MONOMER']   # RhlB
    # deaD is involved in RNA degradation under low temperature growth condition
    Idx_RNAHelicase_DeaD = Comp.Master.ID2Idx_Master['EG10215-MONOMER']   # DeaD
    # all:
    # ATP-dependent RNA helicase DbpA
    # ATP-dependent RNA helicase DeaD (polypeptide)
    # ATP-dependent RNA helicase DeaD (protein complex)
    # ATP-dependent RNA helicase HrpA
    # ATP-dependent RNA helicase RhlB (polypeptide)
    # ATP-dependent RNA helicase RhlB (protein complex)
    # ATP-dependent RNA helicase RhlE
    # ATP-dependent RNA helicase SrmB
    # RNA-dependent NTPase HrpB (putative ATP-dependent RNA helicase HrpB)

    # Degradosome - Complex consisting of Eno (enolase), Pnp (PNPase), RhlB (helicase), Rne (RNaseE), Ppk (Polyphosphate kinase)
    # Degradosome has a membrane-targetting helix

    Idx_Degradosome = Comp.Master.ID2Idx_Master['CPLX0-2381']   # Degradosome
    Idx_Ppk = Comp.Master.ID2Idx_Master[Comp.Protein.Name2ID_Proteins['Ppk']]   # polyphosphate Kinase

    # Set up Idx to Idx system in cell.py

    # Temporary parameters
    # The median mRNA degradation lifetime is roughly 5 minutes in E. coli

    # Total initial mRNA count = 5917
    # Since 5 min average half life, degradation in 5 min = 5917 / 2 = 2958.5
    # degradation in 1 min = 2958.5 / 5 = 591.7 (assuming linear reduction for simplicity of calculation), which is 10 % of the total
    # assume 10 % per min = 0.1 / 60 sec (assuming linear)
    # The proportion of mRNAs getting cleaved by cytosolic RNaseE
    Rate_mRNACleavage_RNaseE = 0.1 / 60

    # # apply arbitrary 1.5 adjustment factor for exponential character for now
    # Rate_mRNACleavage_RNaseE *= 1.5

    # The proportion of mRNAs getting cleaved by membrane-targetted degradosome
    Rate_mRNACleavage_Degradosome = Rate_mRNACleavage_RNaseE / 10   # Arbitrary value

    # PAP I accounts for ~90% of the poly(A) tails in E. coli, which are on average 15â€“30 nt long [10,12,20,48]. However, a limited number of the poly(A) tails can be longer than 30 nt, while the bulk of the tails are less than 10 nt in length.
    Len_PolyA = 20

    # The proportion of cleaved RNAs getting digested by ExoRNases RNaseII
    Rate_ExoRNase_RNaseII = 0.8

    # The proportion of cleaved RNAs getting digested by ExoRNases PNPase
    Rate_ExoRNase_PNPase = 0.9

    # Temporary references
    NUniq_RNAs = Comp.RNA.NUniq_RNAs
    NUniq_mRNAs = Comp.RNA.NUniq_mRNAs
    NUniq_rRNAs = Comp.RNA.NUniq_rRNAs
    NUniq_tRNAs = Comp.RNA.NUniq_tRNAs
    NUniq_miscRNAs = Comp.RNA.NUniq_miscRNAs

    NUniq_NTPs = Comp.BuildingBlock.NUniq_NTPs


    with Writer.Statement("class F%s(FCellProcess):" % ProcessID):
        ProGen.Init_Common(Writer)

        with Writer.Function_("Init_ProcessSpecificVariables"):
            Writer.Variable_("self.Idx_Enolase_RppH", 0)
            Writer.Variable_("self.Idx_EndoRNase_RNaseE", 0)
            Writer.Variable_("self.Idx_ExoRNaseHydrolytic_RNaseII", 0)
            Writer.Variable_("self.Idx_ExoRNaseHydrolytic_RNaseR", 0)
            Writer.Variable_("self.Idx_ExoRNasePhosphorolytic_PNPase", 0)
            Writer.Variable_("self.Idx_PolyAP_PcnB", 0)
            Writer.Variable_("self.Idx_RNAHelicase_RhlB", 0)
            Writer.Variable_("self.Idx_RNAHelicase_DeaD", 0)

            Writer.Variable_("self.Idx_RNAs", 0)
            Writer.Variable_("self.Idx_mRNAs", 0)
            Writer.Variable_("self.Idx_rRNAs", 0)
            Writer.Variable_("self.Idx_tRNAs", 0)
            Writer.Variable_("self.Idx_miscRNAs", 0)

            Writer.Variable_("self.Idx_RndmRNAsToCleave_RNaseE", 0)
            Writer.Variable_("self.Idx_RndmRNAsToCleave_Degradosome", 0)
            Writer.BlankLine()
            Writer.Variable_("self.Rate_mRNACleavage_RNaseE", 0)
            Writer.Variable_("self.Rate_mRNACleavage_Degradosome", 0)
            Writer.Variable_("self.Rate_ExoRNase_RNaseII", 0)
            Writer.Variable_("self.Rate_ExoRNase_PNPase", 0)
            Writer.BlankLine()

            Writer.Variable_("self.Count_NTsInRNAsCleavedTotal", 0)
            Writer.BlankLine()

            Writer.Variable_("self.N_RNAsCleaved", 0)
            Writer.Variable_("self.N_NTPsDigested", 0)
            Writer.BlankLine()

            Writer.Variable_("self.Len_PolyA", 0)
            Writer.BlankLine()

        # Override the abstract method
        with Writer.Function_("SetUp_ProcessSpecificVariables"):
            # Local indices
            Writer.Variable_("self.Idx_Enolase_RppH", Idx_Enolase_RppH)
            Writer.Variable_("self.Idx_EndoRNase_RNaseE", Idx_EndoRNase_RNaseE)
            Writer.Variable_("self.Idx_ExoRNaseHydrolytic_RNaseII", Idx_ExoRNaseHydrolytic_RNaseII)
            Writer.Variable_("self.Idx_ExoRNaseHydrolytic_RNaseR", Idx_ExoRNaseHydrolytic_RNaseR)
            Writer.Variable_("self.Idx_ExoRNasePhosphorolytic_PNPase", Idx_ExoRNasePhosphorolytic_PNPase)
            Writer.Variable_("self.Idx_PolyAP_PcnB", Idx_PolyAP_PcnB)
            Writer.Variable_("self.Idx_RNAHelicase_RhlB", Idx_RNAHelicase_RhlB)
            Writer.Variable_("self.Idx_RNAHelicase_DeaD", Idx_RNAHelicase_DeaD)

            Writer.VarRange_("self.Idx_RNAs", 0, NUniq_RNAs)
            Writer.VarRange_("self.Idx_mRNAs", 0, NUniq_mRNAs)
            Writer.VarRange_("self.Idx_rRNAs", 0, NUniq_rRNAs)
            Writer.VarRange_("self.Idx_tRNAs", 0, NUniq_tRNAs)
            Writer.VarRange_("self.Idx_miscRNAs", 0, NUniq_miscRNAs)
            Writer.BlankLine()

            Writer.Variable_("self.Rate_mRNACleavage_RNaseE", Rate_mRNACleavage_RNaseE)
            Writer.Variable_("self.Rate_mRNACleavage_Degradosome", Rate_mRNACleavage_Degradosome)
            Writer.Variable_("self.Rate_ExoRNase_RNaseII", Rate_ExoRNase_RNaseII)
            Writer.Variable_("self.Rate_ExoRNase_PNPase", Rate_ExoRNase_PNPase)
            Writer.BlankLine()

            Writer.InitZeros("self.Cel.Count_NTsInRNAsCleaved", NUniq_NTPs, 'int32')
            Writer.Variable_("self.Len_PolyA", Len_PolyA)
            Writer.BlankLine()

        # Override the abstract method
        with Writer.Function_("ExecuteProcess"):
            Writer.Statement("self.ResetVariables()")
            Writer.Statement("self.RNACleavage()")
            Writer.Statement("self.RNADigestion()")
            Writer.Statement("self.Degradosome()")
            Writer.BlankLine()

        with Writer.Function_("ResetVariables"):
            Writer.Variable_("self.N_NTPsDigested", 0)
            # Writer.Variable_("self.Count_NTsInRNAsCleavedTotal", 0)
            Writer.Variable_("self.N_RNAsCleaved", 0)
            Writer.BlankLine()

        with Writer.Function_("RNACleavage"):
            Writer.Statement("self.mRNACleavage()")
            Writer.Statement("self.rRNACleavage()")
            Writer.Statement("self.tRNACleavage()")
            Writer.Statement("self.miscRNACleavage()")
            Writer.Statement("self.UpdateByproductsOfRNACleavage()")
            Writer.BlankLine()
            Writer.BlankLine()
    
        # with Writer.Statement("def DetermineRNaseEToBind(self):"):
        #
        #     Writer.Comment__("RetrieveTotalRNaseECount")
        #     Writer.Statement(
        #         "Count_RNaseE30S = tf.constant(self.Cel.Counts[%s])  # %s: Index for RNaseE" % (
        #         Idx_EndoRNase_RNaseE, Idx_EndoRNase_RNaseE))
        #
        #
        #     Writer.Comment__("RNaseE70S count is taken from the lower value between 30S and 50S")
        #     Writer.Minimum__("Count_RNaseE70S", "Count_RNaseE30S",
        #                      "Count_RNaseE50S")
        #
        #     Writer.Comment__("Assume RNaseE count = RNaseE70S count")
        #     Writer.Overwrite("Count_RNaseE", "Count_RNaseE70S")
        #     Writer.Overwrite("self.Count_RNaseE", "Count_RNaseE70S")
        #     Writer.BlankLine()
        #
        #     Writer.Comment__("CalculateActiveRNaseE")
        #     Writer.Cast_____("Count_RNaseE_Float", "Count_RNaseE", 'float32')
        #     Writer.Multiply_("Count_RNaseEActive", "Count_RNaseE_Float",
        #                      "self.Rate_RNaseEActive")  # For summary, active RNaseE
        #     Writer.RoundInt_("Count_RNaseEActive", "Count_RNaseEActive")
        #     Writer.BlankLine()
        #
        #     Writer.Comment__("CalculateActiveRNaseECanBind")
        #     Writer.Cast_____("Count_RNaseEActive_Float", "Count_RNaseEActive", 'float32')
        #     Writer.Multiply_("Count_RNaseEActiveCanBind", "Count_RNaseEActive_Float",
        #                      "self.Rate_RNaseEActiveCanBind")  # For summary, active RNaseE portion that can bind to promoter
        #     Writer.RoundInt_("Count_RNaseEActiveCanBind", "Count_RNaseEActiveCanBind")
        #
        #     Writer.Comment__("DetermineRNaseEWillBind")
        #     Writer.ConvToBin("Bin_RNaseEBound", "self.Cel.Len_ProteinsNascent", ">=", 0)
        #     Writer.ReduceSum("Count_RNaseEBound", "Bin_RNaseEBound")
        #     Writer.Subtract_("Count_RNaseEWillBind", "Count_RNaseEActiveCanBind",
        #                      "Count_RNaseEBound")
        #     Writer.ConvToBin("Bin_RNaseEWillBind", "Count_RNaseEActiveCanBind", ">",
        #                      "Count_RNaseEBound")
        #     Writer.Multiply_("Count_RNaseEWillBind", "Count_RNaseEWillBind",
        #                      "Bin_RNaseEWillBind")  # For Summary, active RNaseE to bind to promoter this step
        #     Writer.ReturnVar("Count_RNaseEWillBind")
        #     Writer.BlankLine()

        with Writer.Function_("DetermineNTsInRNA", "Idx_RNAsSelected"):
            Writer.Transpose("Source", "self.Cel.Count_NTsInRNAs")
            Writer.Statement("Index = tf.reshape(Idx_RNAsSelected, [-1, 1, 1])")
            Writer.Statement("Count_NTsInRNAsSelected = tf.gather(Source, Index)")
            Writer.ReduceSum("Count_NTsInRNAsCleaved", "Count_NTsInRNAsSelected", 0)
            Writer.ReturnVar("Count_NTsInRNAsCleaved")
            Writer.BlankLine()

        #
        # with Writer.Statement("def UpdateCountOfNTsInCleavedRNAs(self, Count_NTsInRNAsCleaved):"):
        #     Writer.Add______("self.Count_NTPs_RNAsCleaved", "self.Count_NTPs_RNAsCleaved", "Count_NTsInRNAsCleaved")
        #     Writer.BlankLine()

        with Writer.Function_("AddToNTPsInRNAsCleaved", "Count_NTsInRNAsCleaved"):
            Writer.Comment__("Add to NTP counts in cleaved RNAs in Cell State")
            Writer.Add______("self.Cel.Count_NTsInRNAsCleaved", "self.Cel.Count_NTsInRNAsCleaved", "Count_NTsInRNAsCleaved")
            Writer.BlankLine()

        with Writer.Function_("AddToNTPsInRNAsCleavedTotal", "Count_NTsInRNAsCleavedTotal"):
            Writer.Comment__("Add to NTP counts total for summary")
            Writer.Add______("self.Count_NTsInRNAsCleavedTotal", "self.Count_NTsInRNAsCleavedTotal", "Count_NTsInRNAsCleavedTotal")
            Writer.BlankLine()

        with Writer.Function_("UpdateNTCountsForRNACleavage", "Idx_RndRNAsToCleave", "Count_NTsInRNAsCleaved"):
            Writer.Statement("self.AddToNTPsInRNAsCleaved(Count_NTsInRNAsCleaved)")
            Writer.BlankLine()
            Writer.Statement("Idx_RndRNAsToCleave_Master = self.IdxFromLocalToReference(Idx_RndRNAsToCleave, self.Cel.Idx_Master_mRNAs)")
            Writer.Statement("self.AddToDeltaCounts_RndIdx(Idx_RndRNAsToCleave_Master)")
            Writer.BlankLine()
            Writer.ShapeAxis("N_RNAsCleaved", "Idx_RndRNAsToCleave", 0)
            Writer.Add______("self.N_RNAsCleaved", "self.N_RNAsCleaved", "N_RNAsCleaved")
            Writer.BlankLine()
            # Writer.ReduceSum("Count_NTsInRNAsCleavedTotal", "Count_NTsInRNAsCleaved")
            # Writer.Statement("self.AddToNTPsInRNAsCleavedTotal(Count_NTsInRNAsCleavedTotal)")
            # Writer.BlankLine()

        with Writer.Function_("UpdateByproductsOfRNACleavage"):
            Writer.Comment__("Consume one water molecule per nucleotide cleaved")
            Writer.Statement("self.AddToDeltaCounts_Hydrolysis(self.N_RNAsCleaved)")
            Writer.BlankLine()

        with Writer.Function_("CleaveRNAs", "Idx_Master_RNA", "Rate_RNACleavage"):
            # TODO: This function should be written more generally to be useful in all RNA cleavage events (i.e. degradosome)
            Writer.Statement("Count_RNAs = self.GetCounts(Idx_Master_RNA)")
            Writer.ReduceSum("Count_RNAsTotal", "Count_RNAs")
            Writer.Statement("N_RNAsToCleave = self.DetermineAmountFromRate(Count_RNAsTotal, Rate_RNACleavage)")
            Writer.Statement("Idx_RndRNAsToCleave = self.PickRandomIndexFromPool_Weighted_Local(N_RNAsToCleave, Idx_Master_RNA, Count_RNAs)")
            Writer.Statement("Count_NTsInRNAsCleaved = self.DetermineNTsInRNA(Idx_RndRNAsToCleave)")
            Writer.Statement("self.UpdateNTCountsForRNACleavage(Idx_RndRNAsToCleave, Count_NTsInRNAsCleaved)")
            Writer.Statement("return N_RNAsToCleave, Count_NTsInRNAsCleaved")
            Writer.BlankLine()

        with Writer.Function_("mRNACleavage"):
            Writer.Statement("N_RNAsCleaved, Count_NTsInRNAsCleaved = self.CleaveRNAs(self.Cel.Idx_Master_mRNAs, self.Rate_mRNACleavage_RNaseE)")
            Writer.BlankLine()

        with Writer.Function_("rRNACleavage"):
            Writer.Pass_____()
            Writer.BlankLine()

        with Writer.Function_("tRNACleavage"):
            Writer.Pass_____()
            Writer.BlankLine()

        with Writer.Function_("miscRNACleavage"):
            Writer.Pass_____()
            Writer.BlankLine()

        with Writer.Function_("UpdateNTCountsForRNADigestion", "Count_NTPsToReplenish"):
            Writer.Subtract_("self.Cel.Count_NTsInRNAsCleaved", "self.Cel.Count_NTsInRNAsCleaved", "Count_NTPsToReplenish")
            Writer.Statement("self.AddToDeltaCounts_NTPs(Count_NTPsToReplenish)")
            Writer.BlankLine()

        with Writer.Function_("UpdateByproductsOfRNaseIIActivity", "N_NTPsToRelease"):
            Writer.Statement("self.AddToDeltaCounts_Hydrolysis(N_NTPsToRelease)")
            Writer.BlankLine()

        with Writer.Function_("UpdateByproductsOfPNPaseActivity", "N_NTPsToRelease"):
            Writer.Statement("self.AddToDeltaCounts_Phosphorolysis(N_NTPsToRelease)")
            Writer.BlankLine()

        with Writer.Function_("DigestRNAs", "N_NTsInRNAsCleaved", "Rate_Digestion"):
            Writer.Statement("Count_NTsDigested = self.DetermineAmountFromRate(N_NTsInRNAsCleaved, Rate_Digestion)")
            Writer.ReduceSum("Count_NTsDigestedTotal", "Count_NTsDigested")
            Writer.Add______("self.N_NTPsDigested", "self.N_NTPsDigested", "Count_NTsDigestedTotal")
            Writer.ReturnVar("Count_NTsDigested")
            Writer.BlankLine()

        with Writer.Function_("RNADigestionByRNaseII", "Count_NTsInRNAsCleaved"):
            Writer.Statement("Count_NTsDigested = self.DigestRNAs(Count_NTsInRNAsCleaved, self.Rate_ExoRNase_RNaseII)")
            Writer.Statement("self.UpdateNTCountsForRNADigestion(Count_NTsDigested)")
            Writer.ReduceSum("Count_NTsDigestedTotal", "Count_NTsDigested")
            Writer.Statement("self.UpdateByproductsOfRNaseIIActivity(Count_NTsDigestedTotal)")
            Writer.BlankLine()

        with Writer.Function_("RNADigestionByPNPase", "Count_NTsInRNAsCleaved"):
            Writer.Statement("Count_NTsDigested = self.DigestRNAs(Count_NTsInRNAsCleaved, self.Rate_ExoRNase_PNPase)")
            Writer.Statement("self.UpdateNTCountsForRNADigestion(Count_NTsDigested)")
            Writer.ReduceSum("Count_NTsDigestedTotal", "Count_NTsDigested")
            Writer.Statement("self.UpdateByproductsOfPNPaseActivity(Count_NTsDigestedTotal)")
            Writer.BlankLine()

        with Writer.Function_("RNADigestion"):
            Writer.Statement("self.RNADigestionByRNaseII(self.Cel.Count_NTsInRNAsCleaved)")
            Writer.BlankLine()

        with Writer.Function_("PolyAdenylationByPAPI", "N_RNAsToPolyAdenylate"):
            Writer.Pass_____()
            Writer.BlankLine()

        with Writer.Function_("Degradosome"):
            # TODO: Check if degradosome should have more time resolved actions from RNA cleavage, polyadenylation and RNA digestion to expand
            Writer.Statement("N_RNAsToCleaved_Degradosome, Count_NTsInRNAsCleaved_Degradosome = self.CleaveRNAs(self.Cel.Idx_Master_mRNAs, self.Rate_mRNACleavage_Degradosome)")
            Writer.Statement("self.PolyAdenylationByPAPI(N_RNAsToCleaved_Degradosome)")
            Writer.Statement("self.RNADigestionByPNPase(Count_NTsInRNAsCleaved_Degradosome)")
            Writer.BlankLine()

        with Writer.Function_("ViewProcessSummary"):
            Writer.Add______("self.Idx_RndmRNAsToCleave", "self.Idx_RndmRNAsToCleave_RNaseE", "self.Idx_RndmRNAsToCleave_Degradosome")

            Writer.PrintStrg("===== RNA Degradation ===== ")
            Writer.PrintStVa("# of RNAs Cleaved",
                             "self.N_RNAsCleaved[0]")
            Writer.PrintStVa("# of NTP digested from RNA degradation",
                             "self.N_NTPsDigested[0]")
            Writer.PrintStVa("# of remaining NTPs from cleaved RNAs to be digested",
                             "self.Cel.Count_NTsInRNAsCleaved[0][0]")
            Writer.BlankLine()
