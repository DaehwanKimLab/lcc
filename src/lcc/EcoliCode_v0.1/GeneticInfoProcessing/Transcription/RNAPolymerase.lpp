// BSD 3-Clause License
// Â© 2022, The University of Texas Southwestern Medical Center. All rights reserved.
// Donghoon M. Lee and Daehwan Kim

// RNA polymerase

// _ : length
// . : location
// ~ : binding
// []: absolute time
// {}: positional reference (subject to reivision)

import SigmaFactor;

protein RpoB, RpoC, RpoA, RpoZ;
complex RNAPCore(RpoB + RpoC + RpoA + RpoZ, Kd=1e-10);
complex RNAPHolo
{
    reaction SigmaFactorBinding(RNAPCore + sigmafactor, Kd=1e-7);
    reaction PromotorBinding(self + promoter --> self~promoter);
}

polymerase RNAP
{
    // transcription initiation
    reaction SigmaFactorRelease(RNAPHolo~promoter --> self~dsDNA + sigmafactor + promoter, Kd=1e-7);
    
    // transcription elongation
    reaction Elongation
    {
        float R = 60.0;
        reaction dsDNAUnwinding(self~dsDNA{n-10:n+10} --> self.ssDNA{n-10:n+10} + ssDNA{n-10:n+10}, r=R);
        reaction DNATranslocation(self.ssDNA{n} --> self.ssDNA{n+1}, r=R);
        reaction RNAElongation(self~RNA_{n} + c(NTP) + self.ssDNA.N{n} + 3 ATP --> self~RNA_{n+1} + PPi + 3 ADP + 3 Pi, r=R); // 1 ATP for building block synthesis, 1.5 ATP for the rest of the process in rich media
    }
    
    // transcription termination
    reaction IntrinsicTermination(self~RNA.terminatorhairpin + ssDNA --> RNAPCore + dsDNA + RNA, Kd=1e-7);
}
